# skulikov-mega-cluster-4 - Kubernetes GitOps Bootstrap

Generated by K8s Bootstrap on 2026-01-14 22:49:59

## Components

### Crds

- **Prometheus Operator CRDs** (v26.0.0)
- **Cert-Manager CRDs** (vv1.19.2)

### System

- **CoreDNS** (v1.45.0)
- **Metrics Server** (v3.13.0)

### Ingress

- **Ingress NGINX** (v4.14.1)

### Security

- **cert-manager** (vv1.19.2)

### Observability

- **Victoria Metrics Operator** (v0.57.1)


## Quick Start

```bash
# 1. Vendor charts (download upstream charts)
./vendor-charts.sh

# 2. Run bootstrap
./bootstrap.sh

# 3. Monitor
kubectl get kustomizations,helmreleases -A
```

## Structure

```
charts/
├── core/                    # Core infrastructure
│   ├── flux-operator/       # Flux Operator
│   ├── flux-instance/       # GitOps config (GitRepository only)
│   └── namespaces/          # All cluster namespaces
├── system/                  # System components
├── observability/           # Monitoring & logging
└── ...                      # Other categories

manifests/
├── kustomizations/          # Static Kustomization files (NOT generated by Helm)
│   ├── 00-namespaces.yaml   # Watches manifests/namespaces/
│   ├── 10-releases-core.yaml # Watches manifests/releases/core/
│   ├── 30-releases-system.yaml
│   └── ...
├── namespaces/              # HelmRelease for namespaces chart
│   └── release.yaml
└── releases/                # All component HelmReleases
    ├── core/
    │   ├── flux-operator.yaml
    │   └── flux-instance.yaml
    ├── system/
    │   └── metrics-server.yaml
    └── ...
```

## Key Concepts

1. **Static Kustomizations**: All Kustomization files are plain YAML in `manifests/kustomizations/`
2. **Namespaces first**: Kustomization "namespaces" creates all NS before components
3. **HelmReleases in manifests/**: Each component has its own HelmRelease file
4. **Values in HelmRelease**: User values are in manifest files, NOT in chart values.yaml
5. **Categories**: Components organized by category with numbered Kustomizations for order

## Adding Components

1. Add namespace to `charts/core/namespaces/values.yaml`
2. Vendor the chart to `charts/<category>/<name>/`
3. Create HelmRelease in `manifests/releases/<category>/<name>.yaml`
4. (If new category) Add Kustomization in `manifests/kustomizations/XX-releases-<category>.yaml`
5. Commit and push

## Security

- `.age/key.txt` - SOPS private key (gitignored)
- SSH keys created in `~/.ssh/flux-skulikov-mega-cluster-4`

